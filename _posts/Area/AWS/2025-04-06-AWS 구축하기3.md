---
title: "사이드 프로젝트를 위한 AWS 구축 해보기3"
date: 2025-04-06
categories: [Book Review, Cloud]
tags: [AWS, InfraStructure, best-practices]
---

## 들어가며
> 이 포스트는 나카가키 겐지의「AWS로 시작하는 인프라 구축의 정석」을 기반으로 작성하였습니다
> - 책: AWS로 시작하는 인프라 구축의 정석
> - 저자: 나카가키 겐지
> - 출판사: 제이펍
> - 챕터: Chapter 4 가상 네트워크 만들기

# 4.1 네트워크
- 네트워크
    - 인프라스트럭처 관리자가 주체가 되어 관리하는 장소
# 4.2 VPC
## 4.2.1 VPC란?
- VPC
    - Amazon Virtual Private Cloud

## 4.2.2 생성 내용
### 이름 태그
- VPC를 식별하기 위핸 이름

### IPv4 CIDR 블록
- VPC에서 사용하는 private 네트워크용 IP 주소 범위
    - 24비트 블록 : 10.0.0.0 ~ 10.255.255.255
    - 20비트 블록 : 172.16.0.0 ~ 172.31.255.255
    - 16비트 블록 : 192.168.0.0 ~ 192.168.255.255
- 최대 16비트인 이유
    - VP 서브넷 마스크를 16비트 이하로 제한해야함

### IPv6 CIDR 블록
- VPC에서 IPv6의 이용 여부 지정

### 테넌시
- VPC 상의 리소스를 전용 하드웨어에서 실행할 지 지정

## 4.2.3 VPC 생성 순서
- VPC 생성해보기
    ![VPC 생성해보기](/assets/images/AWS15.png)
    ![VPC 생성해보기](/assets/images/AWS16.png)
- VPC 생성 결과 확인하기
    ![VPC 생성 결과 확인하기](/assets/images/AWS17.png)

# 4.3 서브넷과 가용 영역
## 4.3.1 서브넷과 가용 영역
- 서브넷 ; VPC의 IP 주소 ㅂ범위를 나누는 단위
    - IP 주소 범위를 나누는 대표적인 이유
        - 역할 분리 : 외부에 공개하는 리소스 여부를 구별
        - 기기 분리  AWS 안에서의 물리적인 이중화(다중화)를 수행
### 역할 분리
- 리소스가 담당하는 역할에 따라 분리
- 리소스가 포함된 그룹 전체에 대해 할당

### 기기 분리
- 내결함성을 높이기 위해 기기를 분리

### 4.3.2 IPv4 CIDR 설계 방법
- CIDR 설계 시 고려해야할 항목
    - 생성할 서브넷의 수
    - 서브넷 안에 생성할 리소스 수
    - 두 항목은 트레이드오프 관계
- 설계 예시

| 서브넷의 CIDR 블록| 서브넷 수 | 리소스 수 |
|------|------|------|
| 00001010.00000000.XXXXXXXX.XXXXXXXX | 256 | 251 |
| 00001010.00000000.XXXX XXXX.XXXXXXXX | 16 | 4091 |
| 00001010.00000000.XX XXXXXX.XXXXXXXX | 4 | 1637909 |

- 서브넷 생성
    ![서브넷 생성](/assets/images/AWS18.png)

# 4.4 인터넷 게이트웨이
## 4.4.1 인터넷 게이트웨이란?
- Internet GateWay
    - VPC에서 생성된 네트워크와 인터넷 사이의 통신을 가능하게 하는 것
## 4.4.3 인터넷 게이트웨이 생성
- 인터넷 게이트웨이 생성
    ![인터넷 게이트웨이 생성](/assets/images/AWS19.png)
    ![인터넷 게이트웨이 생성](/assets/images/AWS20.png)

### VPC에 연결
- VPC에 연결 클릭
    ![인터넷 게이트웨이 생성](/assets/images/AWS21.png)
- 연결 상태 확인 : 상태가 attached로 변경
    ![인터넷 게이트웨이 생성](/assets/images/AWS22.png)

# 4.5 NAT 게이트웨이
## 4.5.1 NAT 게이트웨이란?
- 프라이빗 서브넷의 인스턴스가 인터넷이나 다른 AWS 서비스에 연결할 수 있도록 하는 네트워크 서비스
- 동시에 인터넷에서 해당 인스턴스에 대한 직접 연결을 방지
- 주요 특징
    - IP 주소 변환: 프라이빗 IP 주소를 퍼블릭 IP 주소로 변환하여 인터넷 통신을 가능하게 합니다.
    - 아웃바운드 통신: 내부 네트워크의 리소스가 외부 네트워크로 통신할 수 있게 합니다.
    - 보안 강화: 내부 네트워크 구조를 외부에 노출하지 않아 보안을 강화합니다.
    - 확장성: 많은 인스턴스가 제한된 수의 퍼블릭 IP 주소를 공유할 수 있게 합니다.
## 4.5.4 NAT 게이트웨이 생성
- NAT 게이트웨이 생성
    ![인터넷 게이트웨이 생성](/assets/images/AWS23.png)
    ![인터넷 게이트웨이 생성](/assets/images/AWS24.png)
# 4.6 라우팅 테이블
## 4.6.1 라우팅 테이블이란?
- 라우팅 테이블 
    - 네트워크에서 데이터 패킷이 목적지에 도달하기 위한 경로를 결정하는 데 사용되는 테이블
- 라우팅의 설정
    - 송신 대상지 : 접속 대상 위치에 관한 정보로 송신 대상자는 IP 주소를 지정, IP주소는 특정 값을 지정하거나 CIDR 형식을 이용해 범위로 지정할 수도 있다
    - 타깃 : 경유지에 관한 정보
        | 타깃| 용도|
        |------|------|
        |로컬 | 동일 VPC 안의 리소스에 접근 | 
        |인터넷 게이트웨이 | 퍼블릭 서브넷에 생성된 리소스가 인터넷 서버와 통신 | 
        |NAT 게이트웨이 | 프라이빗 서브넷에 생성된 리소스가 인터넷 서버와 통신 | 
        |VPN 게이트웨이 | VPN을 통해 접속된 독자 네트워크상의 서버와 통신 | 
        |VPC 피어링 | 접속을 허가한 다른 VPC상의 리소스와 통신 | 
## 4.6.3 라우팅 테이블 생성
- 라우팅 테이블 생성
    ![라우팅 테이블 생성](/assets/images/AWS25.png)
    ![라우팅 테이블 생성](/assets/images/AWS26.png)
- 라우팅 설정
    ![라우팅 테이블 생성](/assets/images/AWS27.png)
    ![라우팅 테이블 생성](/assets/images/AWS28.png)
- 서브넷 연결 편집
    ![라우팅 테이블 생성](/assets/images/AWS29.png)
    - public 연결
    ![라우팅 테이블 생성](/assets/images/AWS30.png)

# 4.7 보안 그룹
## 4.7.1 보안 그룹인가?
- VPC 안의 리소스 보호를 위해 외부로의 접근을 제한하는 것
- 브안 그룹이 외부 접근을 제한하게 만들어주는 개념
    - 포트 번호
    - IP 주소
## 4.7.3 보안 그룹 생성 
- 보안 그룹 생성
    ![라우팅 테이블 생성](/assets/images/AWS31.png)
- 보안 그룹 세부 설정
    ![라우팅 테이블 생성](/assets/images/AWS32.png)
    - 인바운드 규칙으로 SSH, HTTP, HTTPS 설정